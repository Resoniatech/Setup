import{u as Y,_ as J,N as K}from"./CardCodeExample-xcIUe0pG.js";import{$ as Q,a as W,b as X,c as ee}from"./request-CS5nCZLh.js";import{c as le,z as ae}from"./zipcodes-BYck022h.js";import{i as te,j as m,S as se,T as re,s as E,x as oe,y as ue,k as ne,b as a,w as o,o as ie,l as i,u as t,B as f,p as y,q as P,N as R,P as g,E as de,G as ve,_ as pe}from"./index-BLhrQPID.js";import{N as n}from"./FormItem-Bx6x5kZc.js";import{N as v}from"./Input-BN6wvFhZ.js";import{N as D}from"./Form-DnSKBLLB.js";import{N as _}from"./Select-CGduaRNo.js";import{N as z}from"./DatePicker-8nNUJjFF.js";import"./RadioGroup-C9CuaTMP.js";import"./download-sglA049O.js";import"./path-BZD2o_vV.js";import"./typeof-QjJsDpFa.js";import"./defineProperty-DJACW-dl.js";const ce=async()=>{try{return await Q("/api/Account/GetAllUser")}catch{return console.log("error"),!1}},me=async p=>{try{return await W("/api/Account/AddUser",p)}catch{return console.log("error"),!1}},fe=async p=>{try{return await X("/api/Account/ModifyUser",p)}catch{return console.log("error"),!1}},ge=async p=>{try{return await ee(`/api/Account/DeleteUser/${p}`)}catch{return console.log("error"),!1}},I=p=>(de("data-v-adcd710a"),p=p(),ve(),p),he={class:"page"},ye={id:"drawer-target",style:{position:"relative",width:"100%",overflow:"hidden","z-index":"0"}},we={class:"flex justify-between flex-col md:flex-row md:gap-4"},be=I(()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",viewBox:"0 -960 960 960",width:"24px",fill:"#5f6368"},[i("path",{d:"M440-122q-121-15-200.5-105.5T160-440q0-66 26-126.5T260-672l57 57q-38 34-57.5 79T240-440q0 88 56 155.5T440-202v80Zm80 0v-80q87-16 143.5-83T720-440q0-100-70-170t-170-70h-3l44 44-56 56-140-140 140-140 56 56-44 44h3q134 0 227 93t93 227q0 121-79.5 211.5T520-122Z"})],-1)),xe=I(()=>i("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"20px",fill:"rgb(255,255,255)"},[i("path",{d:"M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"})],-1)),Se={class:"flex justify-between flex-col md:flex-row md:gap-4"},Ce={class:"flex justify-between flex-col md:flex-row md:gap-4"},Ne={class:"flex justify-between flex-col md:flex-row md:gap-4"},_e={class:"flex justify-between flex-col md:flex-row md:gap-4"},ke={class:"flex justify-between flex-col md:flex-row md:gap-4"},Ae={class:"flex justify-between flex-col md:flex-row md:gap-4"},Ue={class:"flex justify-between flex-col md:flex-row md:gap-4"},$e={class:"flex justify-between flex-col md:flex-row md:gap-4"},Be={class:"flex justify-between flex-col md:flex-row md:gap-4"},qe={class:"flex justify-between flex-col md:flex-row md:gap-4"},Ee=te({__name:"CustomerList",setup(p){const h=m(!1),w=m(!1),c=se(),S=re({page:1,pageSize:10,pageSlot:3,showSizePicker:!0,pageSizes:[5,10,15],onChange:s=>{S.page=s},onUpdatePageSize:s=>{S.pageSize=s,S.page=1}}),k=m([]),T=[{title:"姓氏",key:"surname",render:s=>g("div",{style:"white-space: nowrap;"},s.Surname)},{title:"名字",key:"name",render:s=>g("div",{style:"white-space: nowrap;"},s.Name)},{title:"電子郵件信箱",key:"email",render:s=>g("div",{style:"white-space: nowrap;"},s.Email)},{title:"電話",key:"phone",render:s=>g("div",{style:"white-space: nowrap;"},s.Phone)},{title:"地址",key:"addr",render:s=>g("div",{style:"white-space: nowrap;"},s.Addr)},{title:"生日",key:"birthday",render:s=>g("div",{style:"white-space: nowrap;"},s.Birthday)},{title:"屬性",key:"role",render:s=>g("div",{style:"white-space: nowrap;"},s.Role)},{title:"Action",key:"actions",render:(s,e)=>[g(f,{onClick:()=>F("Edit",s,e),size:"small",style:"margin-right: 8px; color: white; background-color: blue;"},()=>"編輯"),g(f,{onClick:()=>G("Delete",s,e),size:"small",style:"color: white; background-color: red;"},()=>"刪除")]}],b=async()=>{try{let s=await ce();s.success?(console.log(s.data),h.value=!0,k.value=s.data.map(e=>(e.Birthday=e.Birthday.substring(0,10),e)),C.value=k.value,h.value=!1):c.error("失敗")}catch(s){console.log(s)}};b();const U=m(null),u=m({Surname:"",Name:"",Email:"",Phone:"",City:null,Area:null,Street:"",Addr:"",Birthday:null,Role:""}),j={Surname:{required:!0,message:"請輸入姓氏",trigger:["input"]},Name:{required:!0,message:"請輸入名字",trigger:["input"]},Email:{required:!0,message:"請輸入電子信箱郵件",trigger:["input"]},Phone:{required:!0,message:"請輸入電話",trigger:["input"]},City:{required:!0,message:"請選擇縣市",trigger:["input"]},Area:{required:!0,message:"請選擇區域",trigger:["input"]},Street:{required:!0,message:"請輸入地址",trigger:["input"]},Role:{required:!0,message:"請輸入屬性",trigger:["input"]}},$=E(()=>le.map(s=>({label:s.name,value:s.name}))),B=E(()=>u.value.City?ae.filter(s=>s.county===u.value.City).map(s=>({label:`${s.id}`,value:s.id})):[]);oe(()=>u.value.City,()=>{u.value.Area=null});function L(s){const e=new Date(s),d=e.getFullYear(),l=(e.getMonth()+1).toString().padStart(2,"0"),A=e.getDate().toString().padStart(2,"0");return`${d}-${l}-${A}`}const M=s=>{var e;s.preventDefault(),(e=U.value)==null||e.validate(async d=>{if(d)console.log(d),c.error("失敗");else try{(await me({Surname:u.value.Surname,Name:u.value.Name,Email:u.value.Email,Phone:u.value.Phone,Addr:u.value.Area+u.value.Street,Birthday:L(u.value.Birthday),Role:u.value.Role,LastLoginTime:null,IsDeleted:!1,DeletedAt:null})).success?(c.success("成功"),b()):c.error("失敗")}catch(l){console.log(l)}})},x=m(!1),q=m(null),r=m({Surname:"",Name:"",Email:"",Phone:"",City:null,Area:null,Street:"",Addr:"",Birthday:null,Role:""});m(!1),m("right");const V={Surname:{required:!0,message:"請輸入姓氏",trigger:["input"]},Name:{required:!0,message:"請輸入名字",trigger:["input"]},Email:{required:!0,message:"請輸入電子信箱郵件",trigger:["input"]},Phone:{required:!0,message:"請輸入電話",trigger:["input"]},City:{required:!0,message:"請選擇縣市",trigger:["input"]},Area:{required:!0,message:"請選擇區域",trigger:["input"]},Street:{required:!0,message:"請輸入地址",trigger:["input"]},Role:{required:!0,message:"請輸入屬性",trigger:["input"]}},F=(s,e,d)=>{console.log("點擊",`${s}`,`${d}`),console.log(e),c.info(`編輯用戶: ${e.Name}`),x.value=!0,r.value.Id=e.Id,r.value.Surname=e.Surname,r.value.Name=e.Name,r.value.Email=e.Email,r.value.Phone=e.Phone,r.value.Addr=e.Addr,r.value.City=e.City,r.value.Area=e.Area,r.value.Street=e.Street,r.value.Birthday=new Date(e.Birthday).getTime(),console.log(r.value.Birthday),r.value.Role=e.Role},O=s=>{var e;s.preventDefault(),(e=q.value)==null||e.validate(async d=>{if(d)console.log(d),c.error("失敗");else try{const A=new Date(r.value.Birthday).toISOString().split("T")[0];console.log(r.value.Id),(await fe({Id:r.value.Id,Surname:r.value.Surname,Name:r.value.Name,Email:r.value.Email,Phone:r.value.Phone,Addr:r.value.Addr,Birthday:A,Role:r.value.Role})).success?(c.success("成功"),b()):c.error("失敗")}catch(l){console.log(l)}})},Z=Y(),G=(s,e,d)=>{console.log("點擊",`${s}`,`${d}`),c.error(`刪除用戶: ${e.Name}`),Z.error({title:"警告",content:"確定刪除?",positiveText:"確定",negativeText:"不確定",onPositiveClick:async()=>{try{(await ge(e.Id)).success?(c.success("刪除成功"),b()):c.error("刪除失敗")}catch(l){console.log(l)}},onNegativeClick:()=>{c.error("不確定")}})},C=m([]),N=m(""),H=()=>{console.log("搜尋：",N.value);const s=N.value.toLowerCase();C.value=k.value.filter(e=>`${e.Surname}${e.Name}`.toLowerCase().includes(s)||e.Email.toLowerCase().includes(s)||e.Addr.toLowerCase().includes(s)||e.Phone.toLowerCase().includes(s)||e.Birthday.toLowerCase().includes(s)||e.Role.toLowerCase().includes(s)),console.log("Filtered Data:",C.value)};return ue(()=>{}),(s,e)=>{const d=J;return ie(),ne("div",he,[a(d,{title:"客戶名單",ref:"card"},{default:o(()=>[i("div",ye,[i("div",we,[a(t(n),{label:"搜尋:",path:"search",class:"basis-1/3","label-placement":"left"},{default:o(()=>[a(t(v),{placeholder:"請輸入..",value:N.value,"onUpdate:value":e[0]||(e[0]=l=>N.value=l)},null,8,["value"]),a(t(f),{style:{"margin-left":"10px"},onClick:H},{default:o(()=>[y("確認")]),_:1}),a(t(f),{style:{"margin-left":"10px"},onClick:b},{default:o(()=>[be]),_:1})]),_:1}),a(t(f),{onClick:e[1]||(e[1]=l=>w.value=!0),class:"basis-1/8",style:{"background-color":"blue",color:"white","margin-bottom":"10px !important"}},{default:o(()=>[y(" 新增用戶 "),xe]),_:1})]),a(t(P),{show:w.value,"onUpdate:show":e[13]||(e[13]=l=>w.value=l)},{default:o(()=>[a(t(R),{style:{width:"500px","background-color":"white"},title:"新增用戶",bordered:!1,size:"huge",role:"dialog","aria-modal":"true",closable:"",onClose:e[12]||(e[12]=l=>w.value=!1)},{default:o(()=>[a(t(D),{ref_key:"formRef",ref:U,"label-width":80,model:u.value,rules:j},{default:o(()=>[i("div",Se,[a(t(n),{label:"姓氏",path:"surname",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:u.value.Surname,"onUpdate:value":e[2]||(e[2]=l=>u.value.Surname=l),placeholder:"請輸入.."},null,8,["value"])]),_:1}),a(t(n),{label:"名字",path:"name",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:u.value.Name,"onUpdate:value":e[3]||(e[3]=l=>u.value.Name=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),i("div",Ce,[a(t(n),{label:"電子郵件信箱",path:"email",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:u.value.Email,"onUpdate:value":e[4]||(e[4]=l=>u.value.Email=l),placeholder:"請輸入.."},null,8,["value"])]),_:1}),a(t(n),{label:"電話",path:"phone",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:u.value.Phone,"onUpdate:value":e[5]||(e[5]=l=>u.value.Phone=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),i("div",Ne,[a(t(n),{label:"選擇縣市",path:"city",class:"basis-1/2"},{default:o(()=>[a(t(_),{value:u.value.City,"onUpdate:value":e[6]||(e[6]=l=>u.value.City=l),options:$.value,size:"large",placeholder:"請選擇",clearable:""},null,8,["value","options"])]),_:1}),a(t(n),{label:"選擇區域",path:"area",class:"basis-1/2"},{default:o(()=>[a(t(_),{value:u.value.Area,"onUpdate:value":e[7]||(e[7]=l=>u.value.Area=l),options:B.value,size:"large",placeholder:"請選擇",clearable:""},null,8,["value","options"])]),_:1})]),i("div",_e,[a(t(n),{label:"路,巷,門牌,樓層",path:"street",class:"w-full"},{default:o(()=>[a(t(v),{value:u.value.Street,"onUpdate:value":e[8]||(e[8]=l=>u.value.Street=l),placeholder:"請輸入..",class:"w-full"},null,8,["value"])]),_:1})]),i("div",ke,[a(t(n),{label:"生日",path:"birthday",class:"basis-1/2"},{default:o(()=>[a(t(z),{value:u.value.Birthday,"onUpdate:value":e[9]||(e[9]=l=>u.value.Birthday=l),type:"date",placeholder:"請選擇"},null,8,["value"])]),_:1}),a(t(n),{label:"屬性",path:"role",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:u.value.Role,"onUpdate:value":e[10]||(e[10]=l=>u.value.Role=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),a(t(n),null,{default:o(()=>[a(t(f),{onClick:M},{default:o(()=>[y(" 確認 ")]),_:1}),a(t(f),{style:{"margin-left":"5px"},onClick:e[11]||(e[11]=l=>w.value=!1)},{default:o(()=>[y(" 取消 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),a(t(K),{columns:T,data:C.value,pagination:S},null,8,["data","pagination"]),a(t(P),{show:x.value,"onUpdate:show":e[25]||(e[25]=l=>x.value=l)},{default:o(()=>[a(t(R),{style:{width:"500px","background-color":"white"},title:"新增用戶",bordered:!1,size:"huge",role:"dialog","aria-modal":"true",closable:"",onClose:e[24]||(e[24]=l=>x.value=!1)},{default:o(()=>[a(t(D),{ref_key:"editformRef",ref:q,"label-width":80,model:r.value,rules:V},{default:o(()=>[i("div",Ae,[a(t(n),{label:"姓氏",path:"Surname",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:r.value.Surname,"onUpdate:value":e[14]||(e[14]=l=>r.value.Surname=l),placeholder:"請輸入.."},null,8,["value"])]),_:1}),a(t(n),{label:"名字",path:"Name",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:r.value.Name,"onUpdate:value":e[15]||(e[15]=l=>r.value.Name=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),i("div",Ue,[a(t(n),{label:"電子郵件信箱",path:"Email",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:r.value.Email,"onUpdate:value":e[16]||(e[16]=l=>r.value.Email=l),placeholder:"請輸入.."},null,8,["value"])]),_:1}),a(t(n),{label:"電話",path:"Phone",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:r.value.Phone,"onUpdate:value":e[17]||(e[17]=l=>r.value.Phone=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),i("div",$e,[a(t(n),{label:"選擇縣市",path:"city",class:"basis-1/2"},{default:o(()=>[a(t(_),{value:r.value.City,"onUpdate:value":e[18]||(e[18]=l=>r.value.City=l),options:$.value,size:"large",placeholder:"請選擇",clearable:""},null,8,["value","options"])]),_:1}),a(t(n),{label:"選擇區域",path:"area",class:"basis-1/2"},{default:o(()=>[a(t(_),{value:r.value.Area,"onUpdate:value":e[19]||(e[19]=l=>r.value.Area=l),options:B.value,size:"large",placeholder:"請選擇",clearable:""},null,8,["value","options"])]),_:1})]),i("div",Be,[a(t(n),{label:"路,巷,門牌,樓層",path:"street",class:"w-full"},{default:o(()=>[a(t(v),{value:r.value.Street,"onUpdate:value":e[20]||(e[20]=l=>r.value.Street=l),placeholder:"請輸入..",class:"w-full"},null,8,["value"])]),_:1})]),i("div",qe,[a(t(n),{label:"生日",path:"Birthday",class:"basis-1/2"},{default:o(()=>[a(t(z),{value:r.value.Birthday,"onUpdate:value":e[21]||(e[21]=l=>r.value.Birthday=l),type:"date",placeholder:"請選擇"},null,8,["value"])]),_:1}),a(t(n),{label:"屬性",path:"Role",class:"basis-1/2"},{default:o(()=>[a(t(v),{value:r.value.Role,"onUpdate:value":e[22]||(e[22]=l=>r.value.Role=l),placeholder:"請輸入.."},null,8,["value"])]),_:1})]),a(t(n),null,{default:o(()=>[a(t(f),{onClick:O},{default:o(()=>[y(" 確認 ")]),_:1}),a(t(f),{style:{"margin-left":"5px"},onClick:e[23]||(e[23]=l=>x.value=!1)},{default:o(()=>[y(" 取消 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])]),_:1},512)])}}}),Ye=pe(Ee,[["__scopeId","data-v-adcd710a"]]);export{Ye as default};
